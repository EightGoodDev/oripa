(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32036,e=>{"use strict";function s(e){return e.toLocaleString("ja-JP")}function a(e){return`\xa5${e.toLocaleString("ja-JP")}`}function t(e){return("string"==typeof e?new Date(e):e).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric"})}function l(e){return("string"==typeof e?new Date(e):e).toLocaleString("ja-JP",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function r(e){let s="string"==typeof e?new Date(e):e,a=Math.floor((new Date().getTime()-s.getTime())/1e3),l=Math.floor(a/60),r=Math.floor(l/60),n=Math.floor(r/24);return a<60?"たった今":l<60?`${l}分前`:r<24?`${r}時間前`:n<7?`${n}日前`:t(s)}e.s(["formatCoins",()=>s,"formatDate",()=>t,"formatDateTime",()=>l,"formatPrice",()=>a,"formatRelativeTime",()=>r])},43504,e=>{"use strict";var s=e.i(43476),a=e.i(49838);function t({label:e,error:t,children:l,className:r}){return(0,s.jsxs)("div",{className:(0,a.cn)("space-y-1",r),children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:e}),l,t&&(0,s.jsx)("p",{className:"text-xs text-red-400",children:t})]})}e.s(["default",()=>t])},86686,e=>{"use strict";var s=e.i(43476),a=e.i(32098),t=e.i(59544);function l({isOpen:e,onClose:l,onConfirm:r,title:n,message:i,confirmLabel:c="削除",loading:d=!1}){return(0,s.jsx)(a.default,{isOpen:e,onClose:l,children:(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-700 rounded-xl p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-bold mb-2",children:n}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mb-6",children:i}),(0,s.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,s.jsx)(t.default,{variant:"ghost",size:"sm",onClick:l,children:"キャンセル"}),(0,s.jsx)(t.default,{variant:"danger",size:"sm",onClick:r,disabled:d,children:d?"処理中...":c})]})]})})}e.s(["default",()=>l])},9545,e=>{"use strict";e.s(["RANK_COLORS",0,{BEGINNER:"#9ca3af",BRONZE:"#cd7f32",SILVER:"#c0c0c0",GOLD:"#ffd700",PLATINUM:"#e5e4e2",DIAMOND:"#b9f2ff",VIP:"#ff6b6b"},"RANK_LABELS",0,{BEGINNER:"ビギナー",BRONZE:"ブロンズ",SILVER:"シルバー",GOLD:"ゴールド",PLATINUM:"プラチナ",DIAMOND:"ダイヤモンド",VIP:"VIP"}])},28361,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(18566),l=e.i(26732),r=e.i(43504),n=e.i(59544),i=e.i(86686),c=e.i(32036),d=e.i(9545);let o=["USER","ADMIN","SUPER_ADMIN"],x="bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-gold-mid w-full",m="bg-gray-900/50 border border-gray-800 rounded-xl p-6 space-y-4";function h({params:e}){let{id:h}=(0,a.use)(e),p=(0,t.useRouter)(),{data:j}=(0,l.useSession)(),f=j?.user?.role==="SUPER_ADMIN",[u,N]=(0,a.useState)(null),[g,y]=(0,a.useState)(!0),[b,v]=(0,a.useState)(""),[C,A]=(0,a.useState)(""),[S,w]=(0,a.useState)(""),[k,D]=(0,a.useState)(!1),[R,T]=(0,a.useState)("USER"),[L,I]=(0,a.useState)(!1),[P,O]=(0,a.useState)(!1),[E,M]=(0,a.useState)({open:!1,title:"",message:"",onConfirm:()=>{},confirmLabel:""});async function U(){y(!0),v("");let e=await fetch(`/api/admin/users/${h}`);if(e.ok){let s=await e.json();N(s),T(s.role)}else v("ユーザーの取得に失敗しました");y(!1)}async function $(){let e=parseInt(C,10);isNaN(e)||0===e||(D(!0),(await fetch(`/api/admin/users/${h}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({coinAdjust:{amount:e,reason:S}})})).ok&&(A(""),w(""),await U()),D(!1))}async function z(){R===u?.role||(I(!0),(await fetch(`/api/admin/users/${h}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:R})})).ok&&await U(),I(!1))}async function B(){if(!u)return;let e=!u.isActive;M({open:!0,title:e?"アカウント有効化":"アカウント無効化",message:e?"このアカウントを有効化しますか？":"このアカウントを無効化しますか？ユーザーはログインできなくなります。",confirmLabel:e?"有効化":"無効化",onConfirm:async()=>{O(!0),M(e=>({...e,open:!1})),(await fetch(`/api/admin/users/${h}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:e})})).ok&&await U(),O(!1)}})}return((0,a.useEffect)(()=>{U()},[h]),g)?(0,s.jsx)("div",{className:"flex items-center justify-center py-20 text-gray-500",children:"読み込み中..."}):b||!u?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-red-400",children:b||"ユーザーが見つかりません"}),(0,s.jsx)(n.default,{variant:"ghost",size:"sm",onClick:()=>p.push("/admin/users"),children:"戻る"})]}):(0,s.jsxs)("div",{className:"space-y-6 max-w-4xl",children:[(0,s.jsx)("button",{onClick:()=>p.push("/admin/users"),className:"text-sm text-gray-400 hover:text-white transition-colors",children:"← ユーザー一覧に戻る"}),(0,s.jsxs)("div",{className:m,children:[(0,s.jsx)("h2",{className:"text-lg font-bold",children:"ユーザー情報"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 block",children:"名前"}),(0,s.jsx)("span",{children:u.name||"—"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 block",children:"メール"}),(0,s.jsx)("span",{children:u.email||"—"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 block",children:"ロール"}),(0,s.jsx)("span",{className:"SUPER_ADMIN"===u.role?"text-red-400 font-bold":"ADMIN"===u.role?"text-yellow-400 font-bold":"",children:u.role})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 block",children:"ランク"}),(0,s.jsx)("span",{className:"font-bold",style:{color:d.RANK_COLORS[u.rank]},children:d.RANK_LABELS[u.rank]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 block",children:"コイン残高"}),(0,s.jsx)("span",{children:(0,c.formatCoins)(u.coins)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 block",children:"累計消費"}),(0,s.jsx)("span",{children:(0,c.formatCoins)(u.totalSpent)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 block",children:"登録日"}),(0,s.jsx)("span",{children:(0,c.formatDate)(u.createdAt)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 block",children:"ガチャ回数"}),(0,s.jsx)("span",{children:(0,c.formatCoins)(u._count.draws)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 block",children:"状態"}),(0,s.jsx)("span",{className:u.isActive?"text-green-400":"text-red-400",children:u.isActive?"有効":"無効"})]})]})]}),(0,s.jsxs)("div",{className:m,children:[(0,s.jsx)("h2",{className:"text-lg font-bold",children:"コイン調整"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,s.jsx)(r.default,{label:"調整額",className:"flex-1",children:(0,s.jsx)("input",{type:"number",value:C,onChange:e=>A(e.target.value),placeholder:"例: 1000 / -500",className:x})}),(0,s.jsx)(r.default,{label:"理由",className:"flex-[2]",children:(0,s.jsx)("input",{type:"text",value:S,onChange:e=>w(e.target.value),placeholder:"管理者による調整",className:x})})]}),(0,s.jsx)(n.default,{variant:"gold",size:"sm",onClick:$,disabled:k||!C||0===parseInt(C,10),children:k?"処理中...":"コイン調整を実行"})]}),f&&(0,s.jsxs)("div",{className:m,children:[(0,s.jsx)("h2",{className:"text-lg font-bold",children:"ロール変更"}),(0,s.jsxs)("div",{className:"flex items-end gap-3",children:[(0,s.jsx)(r.default,{label:"ロール",className:"w-48",children:(0,s.jsx)("select",{value:R,onChange:e=>T(e.target.value),className:x,children:o.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})}),(0,s.jsx)(n.default,{variant:"outline",size:"sm",onClick:z,disabled:L||R===u.role,children:L?"処理中...":"変更"})]})]}),(0,s.jsxs)("div",{className:m,children:[(0,s.jsx)("h2",{className:"text-lg font-bold",children:"アカウント状態"}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-400",children:["現在の状態:"," ",(0,s.jsx)("span",{className:u.isActive?"text-green-400 font-bold":"text-red-400 font-bold",children:u.isActive?"有効":"無効"})]}),(0,s.jsx)(n.default,{variant:u.isActive?"danger":"gold",size:"sm",onClick:B,disabled:P,children:P?"処理中...":u.isActive?"アカウントを無効化":"アカウントを有効化"})]})]}),(0,s.jsxs)("div",{className:m,children:[(0,s.jsx)("h2",{className:"text-lg font-bold",children:"最近のガチャ"}),0===u.draws.length?(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"ガチャ履歴がありません"}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-800 text-left text-gray-400",children:[(0,s.jsx)("th",{className:"px-3 py-2",children:"景品"}),(0,s.jsx)("th",{className:"px-3 py-2",children:"パック"}),(0,s.jsx)("th",{className:"px-3 py-2",children:"コイン"}),(0,s.jsx)("th",{className:"px-3 py-2",children:"日時"})]})}),(0,s.jsx)("tbody",{children:u.draws.map(e=>(0,s.jsxs)("tr",{className:"border-b border-gray-800/50 hover:bg-gray-900/50",children:[(0,s.jsxs)("td",{className:"px-3 py-2",children:[(0,s.jsx)("span",{className:"text-gray-300",children:e.prize.name}),(0,s.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:e.prize.rarity})]}),(0,s.jsx)("td",{className:"px-3 py-2 text-gray-400",children:e.pack.title}),(0,s.jsx)("td",{className:"px-3 py-2",children:e.isTrial?(0,s.jsx)("span",{className:"text-gray-500",children:"お試し"}):(0,c.formatCoins)(e.coinsCost)}),(0,s.jsx)("td",{className:"px-3 py-2 text-gray-500",children:(0,c.formatDateTime)(e.createdAt)})]},e.id))})]})})]}),(0,s.jsxs)("div",{className:m,children:[(0,s.jsx)("h2",{className:"text-lg font-bold",children:"最近の取引"}),0===u.coinTransactions.length?(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"取引履歴がありません"}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-800 text-left text-gray-400",children:[(0,s.jsx)("th",{className:"px-3 py-2",children:"種別"}),(0,s.jsx)("th",{className:"px-3 py-2",children:"金額"}),(0,s.jsx)("th",{className:"px-3 py-2",children:"残高"}),(0,s.jsx)("th",{className:"px-3 py-2",children:"説明"}),(0,s.jsx)("th",{className:"px-3 py-2",children:"日時"})]})}),(0,s.jsx)("tbody",{children:u.coinTransactions.map(e=>(0,s.jsxs)("tr",{className:"border-b border-gray-800/50 hover:bg-gray-900/50",children:[(0,s.jsx)("td",{className:"px-3 py-2",children:(0,s.jsx)("span",{className:"text-xs font-medium text-gray-400 bg-gray-800 px-2 py-0.5 rounded",children:e.type})}),(0,s.jsxs)("td",{className:`px-3 py-2 font-medium ${e.amount>0?"text-green-400":"text-red-400"}`,children:[e.amount>0?"+":"",(0,c.formatCoins)(e.amount)]}),(0,s.jsx)("td",{className:"px-3 py-2",children:(0,c.formatCoins)(e.balance)}),(0,s.jsx)("td",{className:"px-3 py-2 text-gray-400",children:e.description}),(0,s.jsx)("td",{className:"px-3 py-2 text-gray-500",children:(0,c.formatDateTime)(e.createdAt)})]},e.id))})]})})]}),(0,s.jsx)(i.default,{isOpen:E.open,onClose:()=>M(e=>({...e,open:!1})),onConfirm:E.onConfirm,title:E.title,message:E.message,confirmLabel:E.confirmLabel,loading:P})]})}e.s(["default",()=>h])}]);
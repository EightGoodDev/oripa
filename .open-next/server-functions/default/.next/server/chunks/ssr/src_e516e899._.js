module.exports=[74285,a=>{"use strict";function b(a){return a.toLocaleString("ja-JP")}function c(a){return`\xa5${a.toLocaleString("ja-JP")}`}function d(a){return("string"==typeof a?new Date(a):a).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric"})}function e(a){return("string"==typeof a?new Date(a):a).toLocaleString("ja-JP",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function f(a){let b="string"==typeof a?new Date(a):a,c=Math.floor((new Date().getTime()-b.getTime())/1e3),e=Math.floor(c/60),f=Math.floor(e/60),g=Math.floor(f/24);return c<60?"たった今":e<60?`${e}分前`:f<24?`${f}時間前`:g<7?`${g}日前`:d(b)}a.s(["formatCoins",()=>b,"formatDate",()=>d,"formatDateTime",()=>e,"formatPrice",()=>c,"formatRelativeTime",()=>f])},35785,a=>{"use strict";a.s(["CATEGORY_LABELS",0,{all:"すべて",sneaker:"スニーカー",card:"トレカ",figure:"フィギュア",game:"ゲーム",other:"その他"},"RARITY_CONFIG",0,{N:{label:"N",color:"#9ca3af",bg:"#374151",glow:""},R:{label:"R",color:"#60a5fa",bg:"#1e3a5f",glow:""},SR:{label:"SR",color:"#a78bfa",bg:"#3b1f7a",glow:"0 0 20px rgba(167,139,250,0.5)"},SSR:{label:"SSR",color:"#fbbf24",bg:"#78350f",glow:"0 0 30px rgba(251,191,36,0.6)"},UR:{label:"UR",color:"#f472b6",bg:"#831843",glow:"0 0 40px rgba(244,114,182,0.7)"}}])},55486,a=>{"use strict";var b=a.i(87924),c=a.i(35785);function d({rarity:a}){let d=c.RARITY_CONFIG[a];return(0,b.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-bold",style:{color:d.color,backgroundColor:d.bg},children:d.label})}a.s(["default",()=>d])},51973,a=>{"use strict";var b=a.i(87924),c=a.i(18239);function d({label:a,error:d,children:e,className:f}){return(0,b.jsxs)("div",{className:(0,c.cn)("space-y-1",f),children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:a}),e,d&&(0,b.jsx)("p",{className:"text-xs text-red-400",children:d})]})}a.s(["default",()=>d])},14303,a=>{"use strict";var b=a.i(87924),c=a.i(48313),d=a.i(96438);function e({isOpen:a,onClose:e,onConfirm:f,title:g,message:h,confirmLabel:i="削除",loading:j=!1}){return(0,b.jsx)(c.default,{isOpen:a,onClose:e,children:(0,b.jsxs)("div",{className:"bg-gray-900 border border-gray-700 rounded-xl p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-bold mb-2",children:g}),(0,b.jsx)("p",{className:"text-sm text-gray-400 mb-6",children:h}),(0,b.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,b.jsx)(d.default,{variant:"ghost",size:"sm",onClick:e,children:"キャンセル"}),(0,b.jsx)(d.default,{variant:"danger",size:"sm",onClick:f,disabled:j,children:j?"処理中...":i})]})]})})}a.s(["default",()=>e])},94981,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(95245),f=a.i(59501),g=a.i(56757),h=a.i(96438),i=a.i(55486),j=a.i(51973),k=a.i(14303),l=a.i(48313),m=a.i(35785),n=a.i(74285);let o=g.z.object({title:g.z.string().min(1,"タイトルを入力してください"),description:g.z.string().optional().default(""),image:g.z.string().url("有効なURLを入力してください"),category:g.z.enum(["sneaker","card","figure","game","other"]),pricePerDraw:g.z.coerce.number().int().min(1),totalStock:g.z.coerce.number().int().min(1),limitPerUser:g.z.coerce.number().int().min(1).nullable().optional().transform(a=>a||null),startsAt:g.z.string().optional().default(""),endsAt:g.z.string().optional().default(""),featured:g.z.boolean().optional().default(!1),lastOnePrizeId:g.z.string().nullable().optional(),sortOrder:g.z.coerce.number().int().optional().default(0)}),p=g.z.object({prizeId:g.z.string().min(1,"景品を選択してください"),weight:g.z.coerce.number().int().min(1,"1以上を入力"),totalQuantity:g.z.coerce.number().int().min(1,"1以上を入力")}),q="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-gold-mid",r=Object.entries(m.CATEGORY_LABELS).filter(([a])=>"all"!==a);function s(a){if(!a)return"";let b=new Date(a),c=b.getTimezoneOffset();return new Date(b.getTime()-6e4*c).toISOString().slice(0,16)}function t({params:a}){let{id:g}=(0,c.use)(a),m=(0,d.useRouter)(),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)([]),[J,K]=(0,c.useState)(!1),{register:L,handleSubmit:M,reset:N,formState:{errors:O}}=(0,e.useForm)({resolver:(0,f.zodResolver)(o)}),P=(0,e.useForm)({resolver:(0,f.zodResolver)(p)});async function Q(){let a=await fetch(`/api/admin/packs/${g}`);if(!a.ok)return void m.push("/admin/packs");let b=await a.json();u(b),N({title:b.title,description:b.description,image:b.image,category:b.category,pricePerDraw:b.pricePerDraw,totalStock:b.totalStock,limitPerUser:b.limitPerUser,startsAt:s(b.startsAt),endsAt:s(b.endsAt),featured:b.featured,lastOnePrizeId:b.lastOnePrizeId,sortOrder:b.sortOrder}),w(!1)}async function R(a){y(!0);try{if(!(await fetch(`/api/admin/packs/${g}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,startsAt:a.startsAt||null,endsAt:a.endsAt||null})})).ok)throw Error("Failed to update");await Q(),alert("保存しました")}catch{alert("保存に失敗しました")}finally{y(!1)}}async function S(a){(await fetch(`/api/admin/packs/${g}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a})})).ok?await Q():alert("ステータス変更に失敗しました")}async function T(){C(!0);try{let a=await fetch(`/api/admin/packs/${g}`,{method:"DELETE"});if(!a.ok){let b=await a.json();alert(b.error||"削除に失敗しました");return}m.push("/admin/packs")}finally{C(!1),A(!1)}}async function U(a){K(!0);try{let b=await fetch(`/api/admin/packs/${g}/prizes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok){let a=await b.json();alert(a.error||"追加に失敗しました");return}E(!1),P.reset(),await Q()}finally{K(!1)}}async function V(){if(!F)return;let a=await fetch(`/api/admin/packs/${g}/prizes?packPrizeId=${F}`,{method:"DELETE"});a.ok?await Q():alert((await a.json()).error||"削除に失敗しました"),G(null)}if((0,c.useEffect)(()=>{Q(),fetch("/api/admin/prizes").then(a=>a.json()).then(a=>I(a))},[g]),v||!t)return(0,b.jsx)("p",{className:"text-center text-gray-500 py-20",children:"読み込み中..."});let W=t.packPrizes.reduce((a,b)=>a+b.weight,0),X="DRAFT"===t.status;return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"パック編集"}),(0,b.jsxs)("div",{className:"flex gap-2",children:["DRAFT"===t.status&&(0,b.jsx)(h.default,{size:"sm",onClick:()=>S("ACTIVE"),children:"公開する"}),"ACTIVE"===t.status&&(0,b.jsx)(h.default,{size:"sm",variant:"outline",onClick:()=>S("ENDED"),children:"終了する"}),X&&(0,b.jsx)(h.default,{size:"sm",variant:"danger",onClick:()=>A(!0),children:"削除"})]})]}),(0,b.jsxs)("form",{onSubmit:M(R),className:"max-w-2xl space-y-4 bg-gray-900 border border-gray-800 rounded-xl p-6",children:[(0,b.jsx)(j.default,{label:"タイトル",error:O.title?.message,children:(0,b.jsx)("input",{...L("title"),className:q})}),(0,b.jsx)(j.default,{label:"説明",error:O.description?.message,children:(0,b.jsx)("textarea",{...L("description"),rows:3,className:q})}),(0,b.jsx)(j.default,{label:"画像URL",error:O.image?.message,children:(0,b.jsx)("input",{...L("image"),className:q})}),(0,b.jsx)(j.default,{label:"カテゴリ",error:O.category?.message,children:(0,b.jsx)("select",{...L("category"),className:q,children:r.map(([a,c])=>(0,b.jsx)("option",{value:a,children:c},a))})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(j.default,{label:"1回あたりの価格(コイン)",error:O.pricePerDraw?.message,children:(0,b.jsx)("input",{type:"number",...L("pricePerDraw"),className:q})}),(0,b.jsx)(j.default,{label:"総在庫数",error:O.totalStock?.message,children:(0,b.jsx)("input",{type:"number",...L("totalStock"),className:q})})]}),(0,b.jsx)(j.default,{label:"ユーザーあたりの制限(任意)",children:(0,b.jsx)("input",{type:"number",...L("limitPerUser"),placeholder:"制限なし",className:q})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(j.default,{label:"開始日時(任意)",children:(0,b.jsx)("input",{type:"datetime-local",...L("startsAt"),className:q})}),(0,b.jsx)(j.default,{label:"終了日時(任意)",children:(0,b.jsx)("input",{type:"datetime-local",...L("endsAt"),className:q})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(j.default,{label:"表示順",children:(0,b.jsx)("input",{type:"number",...L("sortOrder"),className:q})}),(0,b.jsx)(j.default,{label:"ラストワン景品",children:(0,b.jsxs)("select",{...L("lastOnePrizeId"),className:q,children:[(0,b.jsx)("option",{value:"",children:"なし"}),t.packPrizes.map(a=>(0,b.jsx)("option",{value:a.prize.id,children:a.prize.name},a.prize.id))]})})]}),(0,b.jsx)(j.default,{label:"",children:(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-300 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",...L("featured"),className:"rounded border-gray-600 bg-gray-800 text-gold-mid focus:ring-gold-mid"}),"注目パックとして表示"]})}),(0,b.jsx)("div",{className:"pt-4",children:(0,b.jsx)(h.default,{type:"submit",disabled:x,children:x?"保存中...":"保存"})})]}),(0,b.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h2",{className:"text-lg font-bold",children:"景品一覧"}),(0,b.jsx)(h.default,{size:"sm",onClick:()=>E(!0),children:"景品追加"})]}),0===t.packPrizes.length?(0,b.jsx)("p",{className:"text-gray-500 text-sm",children:"景品が追加されていません"}):(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-gray-800 text-left",children:[(0,b.jsx)("th",{className:"px-3 py-2 text-gray-400 font-medium",children:"景品名"}),(0,b.jsx)("th",{className:"px-3 py-2 text-gray-400 font-medium",children:"レアリティ"}),(0,b.jsx)("th",{className:"px-3 py-2 text-gray-400 font-medium",children:"重み"}),(0,b.jsx)("th",{className:"px-3 py-2 text-gray-400 font-medium",children:"数量"}),(0,b.jsx)("th",{className:"px-3 py-2 text-gray-400 font-medium",children:"確率"}),(0,b.jsx)("th",{className:"px-3 py-2 text-gray-400 font-medium",children:"操作"})]})}),(0,b.jsx)("tbody",{children:t.packPrizes.map(a=>(0,b.jsxs)("tr",{className:"border-b border-gray-800/50",children:[(0,b.jsx)("td",{className:"px-3 py-2",children:a.prize.name}),(0,b.jsx)("td",{className:"px-3 py-2",children:(0,b.jsx)(i.default,{rarity:a.prize.rarity})}),(0,b.jsx)("td",{className:"px-3 py-2",children:a.weight}),(0,b.jsxs)("td",{className:"px-3 py-2",children:[a.remainingQuantity," / ",a.totalQuantity]}),(0,b.jsx)("td",{className:"px-3 py-2",children:W>0?`${(a.weight/W*100).toFixed(2)}%`:"—"}),(0,b.jsx)("td",{className:"px-3 py-2",children:X&&(0,b.jsx)(h.default,{variant:"danger",size:"sm",onClick:()=>G(a.id),children:"削除"})})]},a.id))})]})]}),(0,b.jsx)(l.default,{isOpen:D,onClose:()=>E(!1),children:(0,b.jsxs)("div",{className:"bg-gray-900 border border-gray-700 rounded-xl p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-bold mb-4",children:"景品を追加"}),(0,b.jsxs)("form",{onSubmit:P.handleSubmit(U),className:"space-y-4",children:[(0,b.jsx)(j.default,{label:"景品",error:P.formState.errors.prizeId?.message,children:(0,b.jsxs)("select",{...P.register("prizeId"),className:q,children:[(0,b.jsx)("option",{value:"",children:"選択してください"}),H.filter(a=>!t.packPrizes.some(b=>b.prizeId===a.id)).map(a=>(0,b.jsxs)("option",{value:a.id,children:["[",a.rarity,"] ",a.name," (",(0,n.formatPrice)(a.marketPrice),")"]},a.id))]})}),(0,b.jsx)(j.default,{label:"重み(確率ウェイト)",error:P.formState.errors.weight?.message,children:(0,b.jsx)("input",{type:"number",...P.register("weight"),className:q})}),(0,b.jsx)(j.default,{label:"数量",error:P.formState.errors.totalQuantity?.message,children:(0,b.jsx)("input",{type:"number",...P.register("totalQuantity"),className:q})}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,b.jsx)(h.default,{type:"submit",size:"sm",disabled:J,children:J?"追加中...":"追加"}),(0,b.jsx)(h.default,{type:"button",variant:"ghost",size:"sm",onClick:()=>E(!1),children:"キャンセル"})]})]})]})}),(0,b.jsx)(k.default,{isOpen:z,onClose:()=>A(!1),onConfirm:T,title:"パック削除",message:"このパックを削除しますか？この操作は元に戻せません。",loading:B}),(0,b.jsx)(k.default,{isOpen:!!F,onClose:()=>G(null),onConfirm:V,title:"景品削除",message:"この景品をパックから削除しますか？"})]})}a.s(["default",()=>t])}];

//# sourceMappingURL=src_e516e899._.js.map